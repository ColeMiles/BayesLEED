""" Contains definitions for example problems for the current data """
# TODO: If anyone else will ever use this, should probably migrate to real configuration files
from .structure import *
from .searchspace import *
from .tleed import *
import numpy as np

# TODO: All (commented out) structures need explicit interlayer vectors now!

FESE_20UC = AtomicStructure(
    # Atomic sites
    [
     Site([1.0, 0.0], 0.1000, ["Fe", "Se"], "Fe top layer"),
     Site([1.0, 0.0], 0.1000, ["Fe", "Se"], "Fe 2nd layer"),
     Site([1.0, 0.0], 0.1000, ["Fe", "Se"], "Fe bulk"),
     Site([0.0, 1.0], 0.1000, ["Fe", "Se"], "Se top layer"),
     Site([0.0, 1.0], 0.1000, ["Fe", "Se"], "Se 2nd layer"),
     Site([0.0, 1.0], 0.1000, ["Fe", "Se"], "Se bulk")
    ],
    # Layer definitions (fractional coordinates)
    [
     Layer([
        Atom(1, 0.25, 0.75, 0.25),  # Top Layer Fe
        Atom(1, 0.75, 0.25, 0.25),  # Top Layer Fe
        Atom(2, 0.25, 0.75, 1.25),  # 2nd Layer Fe
        Atom(2, 0.75, 0.25, 1.25),  # 2nd Layer Fe
        Atom(4, 0.25, 0.25, 0.00),  # Top Layer Se
        Atom(4, 0.75, 0.75, 0.50),  # Top Layer Se
        Atom(5, 0.25, 0.25, 1.00),  # 2nd Layer Se
        Atom(5, 0.75, 0.75, 1.50),  # 2nd Layer Se
        ], [0.0, 0.0, 5.5180 / 2],
        LayerType.SURF,
        "Top 2 unit cells"
     ),
     Layer([
        Atom(3, 0.25, 0.75, 0.25),  # Bulk Fe
        Atom(3, 0.75, 0.25, 0.25),  # Bulk Fe
        Atom(6, 0.25, 0.25, 0.00),  # Bulk Se
        Atom(6, 0.75, 0.75, 0.50),  # Bulk Se
        ], [0.0, 0.0, 5.5180 / 2],
        LayerType.BULK,
        "Bulk"
     )
    ],
    # Unit cell parameters
    [3.7676, 3.7676, 5.5180]
)

STO_1x1 = AtomicStructure(
    # Atomic sites
    [
        Site([1.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "Sr bulk"),
        Site([0.0, 1.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "Ti bulk"),
        Site([0.0, 0.0, 1.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "apO bulk"),
        Site([0.0, 0.0, 0.0, 1.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "eqO bulk"),
    ],
    # Layer definitions (fractional coordinates)
    [
        Layer([
            Atom(2, 0.00, 0.00, 0.00),  # Ti, doubled overlayer, cell 1
            Atom(4, 0.50, 0.00, 0.00),  # O, doubled overlayer, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O, doubled overlayer, cell 1
        ], [3.905 / 2, 3.905 / 2, 3.905 / 2],
            LayerType.SURF,
            "TiO2 doubled overlayer",
        ),
        Layer([
            Atom(2, 0.00, 0.00, 0.00),  # Ti surface 1, cell 1
            Atom(4, 0.50, 0.00, 0.00),  # O surface 1, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O surface 1, cell 1
        ], [3.905 / 2, 3.905 / 2, 3.905 / 2],
            LayerType.SURF,
            "SrTiO3 surface 1 -- TiO2",
        ),
        Layer([
            Atom(1, 0.00, 0.00, 0.00),  # Sr surface 1, cell 1
            Atom(3, 0.50, 0.50, 0.00),  # O surface 1, cell 1
        ], [3.905 / 2, 3.905 / 2, 3.905 / 2],
            LayerType.SURF,
            "SrTiO3 surface 1 -- SrO",
        ),
        Layer([
            Atom(2, 0.00, 0.00, 0.00),  # Ti, bulk, cell 1
            Atom(4, 0.50, 0.00, 0.00),  # O, bulk, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O, bulk, cell 1
        ], [3.905 / 2, 3.905 / 2, 3.905 / 2],
            LayerType.BULK,
            "SrTiO3 bulk -- TiO2",
        ),
        Layer([
            Atom(1, 0.00, 0.00, 0.00),  # Sr, bulk, cell 1
            Atom(3, 0.50, 0.50, 0.00),  # O, bulk, cell 1
        ], [3.905 / 2, 3.905 / 2, 3.905 / 2],
            LayerType.BULK,
            "SrTiO3 bulk -- SrO",
        ),
    ],
    # Unit cell parameters
    [3.905, 3.905, 3.905]
)


STO_2x1 = AtomicStructure(
    # Atomic sites
    [
        Site([1.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "Sr bulk"),
        Site([0.0, 1.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "Ti bulk"),
        Site([0.0, 0.0, 1.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "apO bulk"),
        Site([0.0, 0.0, 0.0, 1.0], 0.1, ["Sr", "Ti", "apO", "eqO"],
             "eqO bulk"),
    ],
    # Layer definitions (fractional coordinates)
    [
        Layer([
            Atom(2, 0.25, 0.50, 0.00),  # Ti, doubled overlayer, cell 1
            Atom(4, 0.25, 0.00, 0.00),  # O, doubled overlayer, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O, doubled overlayer, cell 1
            Atom(2, 0.75, 0.50, 0.00),  # Ti, doubled overlayer, cell 2
            Atom(4, 0.75, 0.00, 0.00),  # O, doubled overlayer, cell 2
            Atom(4, 0.50, 0.50, 0.00),  # O, doubled overlayer, cell 2
        ], [3.905 / 2, 3.905 / 2, 3.905 / 2],
            LayerType.SURF,
            "TiO2 doubled overlayer",
        ),
        Layer([
            Atom(2, 0.25, 0.50, 0.00),  # Ti, bulk, cell 1
            Atom(4, 0.25, 0.00, 0.00),  # O, bulk, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O, bulk, cell 1
            Atom(2, 0.75, 0.50, 0.00),  # Ti, bulk, cell 2
            Atom(4, 0.75, 0.00, 0.00),  # O, bulk, cell 2
            Atom(4, 0.50, 0.50, 0.00),  # O, bulk, cell 2
        ], [0.0, 0.0, 3.905 / 2],
            LayerType.SURF,
            "SrTiO3 surface 1 -- TiO2",
        ),
        Layer([
            Atom(1, 0.00, 0.00, 0.00),  # Sr, bulk, cell 1
            Atom(3, 0.25, 0.50, 0.00),  # O, bulk, cell 1
            Atom(1, 0.50, 0.00, 0.00),  # Sr, bulk, cell 2
            Atom(3, 0.75, 0.50, 0.00),  # O, bulk, cell 2
        ], [0.0, 0.0, 3.905 / 2],
            LayerType.SURF,
            "SrTiO3 surface 1 -- SrO",
        ),
        Layer([
            Atom(2, 0.25, 0.50, 0.00),  # Ti, bulk, cell 1
            Atom(4, 0.25, 0.00, 0.00),  # O, bulk, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O, bulk, cell 1
            Atom(2, 0.75, 0.50, 0.00),  # Ti, bulk, cell 2
            Atom(4, 0.75, 0.00, 0.00),  # O, bulk, cell 2
            Atom(4, 0.50, 0.50, 0.00),  # O, bulk, cell 2
        ], [0.0, 0.0, 3.905 / 2],
            LayerType.BULK,
            "SrTiO3 bulk -- TiO2",
        ),
        Layer([
            Atom(1, 0.00, 0.00, 0.00),  # Sr, bulk, cell 1
            Atom(3, 0.25, 0.50, 0.00),  # O, bulk, cell 1
            Atom(1, 0.50, 0.00, 0.00),  # Sr, bulk, cell 2
            Atom(3, 0.75, 0.50, 0.00),  # O, bulk, cell 2
        ], [0.0, 0.0, 3.905 / 2],
            LayerType.BULK,
            "SrTiO3 bulk -- SrO",
        ),
    ],
    # Unit cell parameters
    [7.810, 3.905, 3.905]
)


# Z-displacements given by picoscale structure paper
FESE_1UC_1x1 = AtomicStructure(
    # Atomic sites
    [
        Site([1.0, 0.0, 0.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Sr bulk"),
        Site([0.0, 1.0, 0.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Ti bulk"),
        Site([0.0, 0.0, 1.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "apO bulk"),
        Site([0.0, 0.0, 0.0, 1.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "eqO bulk"),
        Site([0.0, 0.0, 0.0, 0.0, 1.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Fe film"),
        Site([0.0, 0.0, 0.0, 0.0, 0.0, 1.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Se film"),
    ],
    # Layer definitions (fractional coordinates)
    [
        Layer([
            Atom(5, 0.00, 0.50, 1.43 / 3.9),            # Top Layer Fe, cell 1
            Atom(5, 0.50, 0.00, 1.43 / 3.9),            # Top Layer Fe, cell 1
            Atom(6, 0.50, 0.50, 0.00),                  # Top Layer Se, cell 1
            Atom(6, 0.00, 0.00, (1.43 + 1.35) / 3.9),   # Top Layer Se, cell 1
        ], [3.905 / 2, 0.0, 2.920],   # This shift makes the Ti in doubled layer line up with Fe
            LayerType.SURF,
            "Top FeSe film",
        ),
        Layer([
            Atom(2, 0.00, 0.00, 0.00),  # Ti, doubled overlayer, cell 1
            Atom(4, 0.50, 0.00, 0.00),  # O, doubled overlayer, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O, doubled overlayer, cell 1
        ], [3.905 / 2, 3.905 / 2, 2.340],
            LayerType.SURF,
            "TiO2 doubled overlayer",
        ),
        Layer([
            Atom(2, 0.00, 0.00, 0.00),  # Ti surface 1, cell 1
            Atom(4, 0.50, 0.00, 0.00),  # O surface 1, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O surface 1, cell 1
        ], [3.905 / 2, 3.905 / 2, 1.91],
            LayerType.SURF,
            "SrTiO3 surface 1 -- TiO2",
        ),
        Layer([
            Atom(1, 0.00, 0.00, 0.00),  # Sr surface 1, cell 1
            Atom(3, 0.50, 0.50, 0.00),  # O surface 1, cell 1
        ], [3.905 / 2, 3.905 / 2, 1.95],
            LayerType.SURF,
            "SrTiO3 surface 1 -- SrO",
        ),
        Layer([
            Atom(2, 0.00, 0.00, 0.00),  # Ti, bulk, cell 1
            Atom(4, 0.50, 0.00, 0.00),  # O, bulk, cell 1
            Atom(4, 0.00, 0.50, 0.00),  # O, bulk, cell 1
        ], [3.905 / 2, 3.905 / 2, 1.95],
            LayerType.BULK,
            "SrTiO3 bulk -- TiO2",
        ),
        Layer([
            Atom(1, 0.00, 0.00, 0.00),  # Sr, bulk, cell 1
            Atom(3, 0.50, 0.50, 0.00),  # O, bulk, cell 1
        ], [3.905 / 2, 3.905 / 2, 1.95],
            LayerType.BULK,
            "SrTiO3 bulk -- SrO",
        ),
    ],
    # Unit cell parameters
    [3.905, 3.905, 3.900]
)

# TODO: Should I add one more tunable layer of TiO2?
FESE_1UC_2x1 = AtomicStructure(
    # Atomic sites
    [
     Site([1.0, 0.0, 0.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Sr bulk"),
     Site([0.0, 1.0, 0.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Ti bulk"),
     Site([0.0, 0.0, 1.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "apO bulk"),
     Site([0.0, 0.0, 0.0, 1.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "eqO bulk"),
     Site([0.0, 0.0, 0.0, 0.0, 1.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Fe film"),
     Site([0.0, 0.0, 0.0, 0.0, 0.0, 1.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"], "Se film"),
    ],
    # Layer definitions (fractional coordinates)
    [
     Layer([
         Atom(5, 0.25, 0.50, 0.25),   # Top Layer Fe, cell 1
         Atom(5, 0.50, 0.00, 0.25),   # Top Layer Fe, cell 1
         Atom(6, 0.25, 0.00, 0.00),   # Top Layer Se, cell 1
         Atom(6, 0.50, 0.50, 0.50),   # Top Layer Se, cell 1
         Atom(5, 0.75, 0.50, 0.25),   # Top Layer Fe, cell 2
         Atom(5, 1.00, 0.00, 0.25),   # Top Layer Fe, cell 2
         Atom(6, 0.75, 0.00, 0.00),   # Top Layer Se, cell 2
         Atom(6, 1.00, 0.50, 0.50),   # Top Layer Se, cell 2
         ], [0.0, 0.0, 5.5180 / 2],
         LayerType.SURF,
         "Top FeSe film",
     ),
     Layer([
         Atom(2, 0.75, 0.00, 0.00),   # Ti, doubled overlayer, cell 1
         Atom(2, 0.50, 0.50, 0.00),   # Ti, doubled overlayer, cell 2
         Atom(4, 0.50, 0.00, 0.00),   # O, doubled overlayer, cell 1
         Atom(4, 0.75, 0.50, 0.00),   # O, doubled overlayer, cell 1
         Atom(4, 0.25, 0.50, 0.00),   # O, doubled overlayer, cell 2
         Atom(4, 0.00, 0.00, 0.00),   # O, doubled overlayer, cell 2
         ], [0.0, 0.0, 3.905 / 2],
         LayerType.SURF,
         "TiO2 doubled overlayer",
     ),
     # TODO: For efficiency, split the bulk into two layers and alternate?
     Layer([
         Atom(2, 0.25, 0.50, 0.50),   # Ti, bulk, cell 1
         Atom(2, 0.75, 0.50, 0.50),   # Ti, bulk, cell 2
         Atom(4, 0.00, 0.50, 0.50),   # O, bulk, cell 1
         Atom(4, 0.25, 0.00, 0.50),   # O, bulk, cell 1
         Atom(4, 0.50, 0.00, 0.50),   # O, bulk, cell 2
         Atom(4, 0.75, 0.00, 0.50),   # O, bulk, cell 2
         Atom(1, 0.00, 0.00, 0.00),   # Sr, bulk, cell 1
         Atom(1, 0.50, 0.00, 0.00),   # Sr, bulk, cell 2
         Atom(3, 0.25, 0.50, 0.00),   # O, bulk, cell 1
         Atom(3, 0.75, 0.50, 0.00),   # O, bulk, cell 2
         ], [0.0, 0.0, 3.905 / 2],
         LayerType.BULK,
         "SrTiO3 bulk",
     ),
    ],
    # Unit cell parameters
    [7.810, 3.905, 3.905]
)

FESE_SQRT13_SCIENCE = AtomicStructure(
    [
        Site([1.0, 0.0, 0.0, 0.0, 0.0, 0.0], 0.1, ['Sr', 'Ti', 'apO', 'eqO', 'Fe', 'Se'], 'Sr bulk'),
        Site([0.0, 1.0, 0.0, 0.0, 0.0, 0.0], 0.1, ['Sr', 'Ti', 'apO', 'eqO', 'Fe', 'Se'], 'Ti bulk'),
        Site([0.0, 0.0, 1.0, 0.0, 0.0, 0.0], 0.1, ['Sr', 'Ti', 'apO', 'eqO', 'Fe', 'Se'], 'apO bulk'),
        Site([0.0, 0.0, 0.0, 1.0, 0.0, 0.0], 0.1, ['Sr', 'Ti', 'apO', 'eqO', 'Fe', 'Se'], 'eqO bulk'),
        Site([0.0, 0.0, 0.0, 0.0, 1.0, 0.0], 0.1, ['Sr', 'Ti', 'apO', 'eqO', 'Fe', 'Se'], 'Fe film'),
        Site([0.0, 0.0, 0.0, 0.0, 0.0, 1.0], 0.1, ['Sr', 'Ti', 'apO', 'eqO', 'Fe', 'Se'], 'Se film'),
    ],
    [
        Layer([
            Atom(6, 0.07692292541891607, 0.11538474325013864, 0.0),
            Atom(6, 0.92307723575758, 0.8846154179263575, 0.0),
            Atom(6, 0.30769241191919333, 0.9615383433452735, 0.0),
            Atom(6, 0.6923077492573028, 0.03846181783122258, 0.0),
            Atom(6, 0.846154310338664, 0.2692305940879708, 0.0),
            Atom(6, 0.15384585083783214, 0.7307695670885254, 0.0),
            Atom(6, 0.6153848238383867, 0.423077155169332, 0.0),
            Atom(6, 0.38461533733810943, 0.5769230060071642, 0.0),
            Atom(6, 0.4615382627570255, 0.19230766866905472, 0.0),
            Atom(6, 0.5384618984194707, 0.8076924925074415, 0.0),
            Atom(6, 0.2307694865002773, 0.34615422975041593, 0.0),
            Atom(6, 0.7692306746762189, 0.6538459314260802, 0.0),
            Atom(6, 0.0, 0.5000000805882481, 0.0),
        ],
            [0.     , 0.     , 1.43313],
            LayerType.SURF,
            'FeSe layer'
        ),
        Layer([
            Atom(5, 0.07692292541891607, 0.6153848238383867, 0.0),
            Atom(5, 0.92307723575758, 0.38461533733810943, 0.0),
            Atom(5, 0.6153848238383867, 0.92307723575758, 0.0),
            Atom(5, 0.38461533733810943, 0.07692292541891607, 0.0),
            Atom(5, 0.5384618984194707, 0.30769241191919333, 0.0),
            Atom(5, 0.4615382627570255, 0.6923077492573028, 0.0),
            Atom(5, 0.30769241191919333, 0.4615382627570255, 0.0),
            Atom(5, 0.6923077492573028, 0.5384618984194707, 0.0),
            Atom(5, 0.2307694865002773, 0.846154310338664, 0.0),
            Atom(5, 0.7692306746762189, 0.15384585083783214, 0.0),
            Atom(5, 0.846154310338664, 0.7692306746762189, 0.0),
            Atom(5, 0.15384585083783214, 0.2307694865002773, 0.0),
            Atom(5, 0.0, 0.0, 0.0),
            Atom(5, 0.9615383433452735, 0.19230766866905472, 0.0),
            Atom(5, 0.03846181783122258, 0.8076924925074415, 0.0),
            Atom(5, 0.19230766866905472, 0.03846181783122258, 0.0),
            Atom(5, 0.8076924925074415, 0.9615383433452735, 0.0),
            Atom(5, 0.11538474325013864, 0.423077155169332, 0.0),
            Atom(5, 0.8846154179263575, 0.5769230060071642, 0.0),
            Atom(5, 0.423077155169332, 0.8846154179263575, 0.0),
            Atom(5, 0.5769230060071642, 0.11538474325013864, 0.0),
            Atom(5, 0.5000000805882481, 0.5000000805882481, 0.0),
            Atom(5, 0.7307695670885254, 0.34615422975041593, 0.0),
            Atom(5, 0.2692305940879708, 0.6538459314260802, 0.0),
            Atom(5, 0.34615422975041593, 0.2692305940879708, 0.0),
            Atom(5, 0.6538459314260802, 0.7307695670885254, 0.0),
        ],
            [0.     , 0.     , 1.35555],
            LayerType.SURF,
            'FeSe layer'
        ),
        Layer([
            Atom(6, 0.11538474325013864, 0.92307723575758, 0.0),
            Atom(6, 0.8846154179263575, 0.07692292541891607, 0.0),
            Atom(6, 0.9615383433452735, 0.6923077492573028, 0.0),
            Atom(6, 0.03846181783122258, 0.30769241191919333, 0.0),
            Atom(6, 0.2692305940879708, 0.15384585083783214, 0.0),
            Atom(6, 0.7307695670885254, 0.846154310338664, 0.0),
            Atom(6, 0.423077155169332, 0.38461533733810943, 0.0),
            Atom(6, 0.5769230060071642, 0.6153848238383867, 0.0),
            Atom(6, 0.19230766866905472, 0.5384618984194707, 0.0),
            Atom(6, 0.8076924925074415, 0.4615382627570255, 0.0),
            Atom(6, 0.34615422975041593, 0.7692306746762189, 0.0),
            Atom(6, 0.6538459314260802, 0.2307694865002773, 0.0),
            Atom(6, 0.5000000805882481, 0.0, 0.0),
        ],
            [0.     , 0.     , 2.37931],
            LayerType.SURF,
            'FeSe layer'
        ),
        Layer([
            Atom(2, 0.15715771641401427, 0.08846154179263574, 0.10996527001763144),
            Atom(2, 0.35403367146222475, 0.26754305546283486, 0.23644413226482774),
            Atom(2, 0.5499998045496612, 0.4500003566268349, 0.2374055035847446),
            Atom(2, 0.5832576680431857, 0.10964242431738452, 0.2374055035847446),
            Atom(2, 0.6388995665997502, 0.7568710167828623, 0.10995817502634019),
            Atom(2, 0.7807692910499385, 0.29615379554547366, 0.2374055035847446),
            Atom(2, 0.8135797011201316, 0.9486729920591996, 0.23740195608909928),
            Atom(2, 0.8812254255619747, 0.5790132527132984, 0.23738776610651738),
            Atom(2, 0.1121964600480195, 0.4174420830094716, 0.2374055035847446),
            Atom(2, 0.28306045608655933, 0.6317360503652718, 0.1099936499827946),
            Atom(2, 0.40331604945924937, 0.9051499788396274, 0.10996881751327675),
            Atom(2, 0.08846012130557755, 0.8213582882508085, 0.2097421325415325),
            Atom(4, 0.06930556356934425, 0.6281230415327522, 0.19696405322662466),
            Atom(4, 0.9227476827600788, 0.37060720421371735, 0.16157423666762455),
            Atom(4, 0.635935720352826, 0.9227214037495022, 0.1543586305247814),
            Atom(4, 0.5334489995910998, 0.32131417256375633, 0.21063610144418587),
            Atom(4, 0.4586681686559421, 0.6862955377834915, 0.16309256480387663),
            Atom(4, 0.31380476773060734, 0.4665944864406713, 0.16309256480387663),
            Atom(4, 0.21660154858183828, 0.8505017109802705, 0.1409490969849836),
            Atom(4, 0.7754218675193627, 0.14976905298081186, 0.0),
            Atom(4, 0.8499221522605268, 0.7797195511139322, 3.547495645503842e-05),
            Atom(4, 0.14210126384067415, 0.21661149199124563, 0.13223644767976087),
            Atom(4, -0.0038473891971217244, 0.003997250581761319, 0.046369315581665294),
        ],
            [0.     , 0.     , 2.14967],
            LayerType.SURF,
            'Ti layer'
        ),
        Layer([
            Atom(2, -0.004000091555877709, -0.0017244712886489838, 0.0),
            Atom(2, 0.15144380722242404, 0.2347674473255677, 0.007499405794479046),
            Atom(2, 0.30369303060684477, 0.46046153356691355, 0.047930213665662406),
            Atom(2, 0.38066425258573944, 0.08087898187598971, 0.04874613766411569),
            Atom(2, 0.4584536751101546, 0.6963014486214185, 2.4832469517833716e-05),
            Atom(2, 0.5344674888118257, 0.303694451093903, 0.0),
            Atom(2, 0.6193849153942643, 0.9270680941475795, 0.05380131895888084),
            Atom(2, 0.6883893357072712, 0.5424136934153697, 5.3212434681612385e-05),
            Atom(2, 0.7652341343379867, 0.15309370294051777, 0.0016105630230334117),
            Atom(2, 0.8421542187827863, 0.7731270706768483, 0.05287187509977307),
            Atom(2, 0.9193157860274791, 0.38861258791987074, 0.00010997236500853956),
            Atom(2, 0.07293064654185843, 0.6145147755152421, 0.06370592680097469),
            Atom(2, 0.22676939494439957, 0.8501522711639544, 0.014395737329232522),
            Atom(4, 0.2681311371049277, 0.15575356495698828, 0.08142566754999257),
            Atom(4, 0.426700817654788, 0.38860619572810884, 0.05921479731383601),
            Atom(4, 0.5033048437291392, -0.0010944852783394087, 0.014576659607149878),
            Atom(4, 0.5769911893859574, 0.6193032373884182, 0.11626207478830278),
            Atom(4, 0.6538494826437257, 0.2347660268385095, 0.014434759781332244),
            Atom(4, 0.7345636880209648, 0.8469057479924493, 0.11602794007570318),
            Atom(4, 0.811611616301002, 0.46544034070588775, 0.0486645452642703),
            Atom(4, 0.8885594002434366, 0.08089105601598438, 0.08110284544625695),
            Atom(4, 0.9576092761423056, 0.6962275832943924, 0.017230186349946167),
            Atom(4, 0.042459778656513, 0.31140485484578656, 0.11626562228394809),
            Atom(4, 0.19629497584140868, 0.5424555977835864, 0.01923097389397933),
            Atom(4, 0.34660026268668925, 0.7732279252579801, 0.016293647499547773),
            Atom(4, 0.11691815902946037, 0.9270702248781668, 0.07579933945631032),
            Atom(4, 0.08090881210421183, 0.1115700252553554, 0.09385254479600103),
            Atom(4, 0.23476389610792223, 0.34393542896551504, 0.014331882407614334),
            Atom(4, 0.38861258791987074, 0.5729257554254029, 0.11625852729265745),
            Atom(4, 0.4655184674940885, 0.18831681027905528, 0.01431414492938713),
            Atom(4, 0.5363979307239131, 0.8038195345432722, 0.014360262372777483),
            Atom(4, 0.6193849153942643, 0.4217376358734539, 0.11623724231878493),
            Atom(4, 0.7732137203873982, 0.655008600083213, 0.0313101965667337),
            Atom(4, 0.8442657727947935, 0.2652340537497386, 0.05863300802798233),
            Atom(4, 0.9270759068263996, 0.8806323722151781, 0.01433542990325965),
            Atom(4, 0.0039894379029412445, 0.5013630379205863, 0.01471855943296814),
            Atom(4, 0.1577109961231813, 0.726793623812637, 0.014310597433741185),
            Atom(4, 0.3116782986044891, 0.9575517464164487, 0.11626562228394809),
            Atom(4, 0.6962915052120112, 0.03456968329176771, 0.09422148434312763),
        ],
            [0.     , 0.     , 1.52489],
            LayerType.SURF,
            'Ti layer'
        ),
        Layer([
            Atom(1, 0.18930760000214641, 0.04146117625460176, 0.08322779533788117),
            Atom(1, 0.3491535881737951, 0.27222782178076266, 0.08322779533788117),
            Atom(1, 0.5029930468198653, 0.5030001492551563, 0.006757979204580527),
            Atom(1, 0.5799216541870142, 0.1124315506561508, 0.06989985419792874),
            Atom(1, 0.650846573002701, 0.7296935481419424, 0.006757979204580527),
            Atom(1, 0.7277694984216171, 0.3491535881737951, 0.006896331534752845),
            Atom(1, 0.8106918509308206, 0.9585446668701272, 0.006757979204580527),
            Atom(1, 0.8816245824253275, 0.5739250680708431, 0.08321715285094491),
            Atom(1, 0.9645384120121818, 0.195307737335963, 0.01913164401590705),
            Atom(1, 0.11238538482675946, 0.4260473936080182, 0.006757979204580527),
            Atom(1, 0.27222853202429176, 0.6568438693624012, 0.006871499065234697),
            Atom(1, 0.42607509310565295, 0.8875863666085728, 0.08318167789449019),
            Atom(1, 0.0354617491643143, 0.8046924238405332, 0.08322424784223555),
            Atom(3, -0.0029972276927918914, -0.00298870477044272, 0.07644143616813687),
            Atom(3, 0.15090402214030987, 0.22780564025335298, 0.07645917364636438),
            Atom(3, 0.31066478108846685, 0.4585389043336463, 0.0),
            Atom(3, 0.38429714823707367, 0.07428792192596395, 0.07645562615071876),
            Atom(3, 0.4586014057642069, 0.68931904448686, 0.07645917364636438),
            Atom(3, 0.5355115467995992, 0.30469802520051786, 0.061002735119142414),
            Atom(3, 0.6124394439232189, 0.920107707562423, 0.017897115531290555),
            Atom(3, 0.6893240161915638, 0.5354696424313825, 8.159239984539105e-05),
            Atom(3, 0.7662348674704852, 0.15087561239914596, 0.07646626863765502),
            Atom(3, 0.8487360455669338, 0.7683165912542702, 1.4189982581889335e-05),
            Atom(3, 0.9202121133612002, 0.38162024037590486, 0.07642015119426435),
            Atom(3, 0.07395339722375897, 0.612389016632653, 4.611744339066772e-05),
            Atom(3, 0.2277708383204272, 0.8431563724023431, 0.00010642486936353985),
        ],
            [0.     , 0.     , 1.82982],
            LayerType.SURF,
            'Sr layer'
        ),
        Layer([
            Atom(2, 0.0, 0.0, 0.0),
            Atom(2, 0.15384585083783214, 0.2307694865002773, 0.0),
            Atom(2, 0.30769241191919333, 0.4615382627570255, 0.0),
            Atom(2, 0.38461533733810943, 0.07692292541891607, 0.0),
            Atom(2, 0.4615382627570255, 0.6923077492573028, 0.0),
            Atom(2, 0.5384618984194707, 0.30769241191919333, 0.0),
            Atom(2, 0.6153848238383867, 0.92307723575758, 0.0),
            Atom(2, 0.6923077492573028, 0.5384618984194707, 0.0),
            Atom(2, 0.7692306746762189, 0.15384585083783214, 0.0),
            Atom(2, 0.846154310338664, 0.7692306746762189, 0.0),
            Atom(2, 0.92307723575758, 0.38461533733810943, 0.0),
            Atom(2, 0.07692292541891607, 0.6153848238383867, 0.0),
            Atom(2, 0.2307694865002773, 0.846154310338664, 0.0),
            Atom(4, 0.2692305940879708, 0.15384585083783214, 0.02695741940976766),
            Atom(4, 0.423077155169332, 0.38461533733810943, 0.02695741940976766),
            Atom(4, 0.5000000805882481, 0.0, 0.02695741940976766),
            Atom(4, 0.5769230060071642, 0.6153848238383867, 0.02695741940976766),
            Atom(4, 0.6538459314260802, 0.2307694865002773, 0.02695741940976766),
            Atom(4, 0.7307695670885254, 0.846154310338664, 0.02695741940976766),
            Atom(4, 0.8076924925074415, 0.4615382627570255, 0.02695741940976766),
            Atom(4, 0.8846154179263575, 0.07692292541891607, 0.02695741940976766),
            Atom(4, 0.9615383433452735, 0.6923077492573028, 0.02695741940976766),
            Atom(4, 0.03846181783122258, 0.30769241191919333, 0.02695741940976766),
            Atom(4, 0.19230766866905472, 0.5384618984194707, 0.02695741940976766),
            Atom(4, 0.34615422975041593, 0.7692306746762189, 0.02695741940976766),
            Atom(4, 0.11538474325013864, 0.92307723575758, 0.02695741940976766),
            Atom(4, 0.07692292541891607, 0.11538474325013864, 0.02695741940976766),
            Atom(4, 0.2307694865002773, 0.34615422975041593, 0.02695741940976766),
            Atom(4, 0.38461533733810943, 0.5769230060071642, 0.02695741940976766),
            Atom(4, 0.4615382627570255, 0.19230766866905472, 0.02695741940976766),
            Atom(4, 0.5384618984194707, 0.8076924925074415, 0.02695741940976766),
            Atom(4, 0.6153848238383867, 0.423077155169332, 0.02695741940976766),
            Atom(4, 0.7692306746762189, 0.6538459314260802, 0.02695741940976766),
            Atom(4, 0.846154310338664, 0.2692305940879708, 0.02695741940976766),
            Atom(4, 0.92307723575758, 0.8846154179263575, 0.02695741940976766),
            Atom(4, 0.0, 0.5000000805882481, 0.02695741940976766),
            Atom(4, 0.15384585083783214, 0.7307695670885254, 0.02695741940976766),
            Atom(4, 0.30769241191919333, 0.9615383433452735, 0.02695741940976766),
            Atom(4, 0.6923077492573028, 0.03846181783122258, 0.02695741940976766),
        ],
            [0.     , 0.     , 1.84095],
            LayerType.SURF,
            'Ti layer'
        ),
        Layer([
            Atom(1, 0.19230766866905472, 0.03846181783122258, 0.013668500721915418),
            Atom(1, 0.34615422975041593, 0.2692305940879708, 0.013668500721915418),
            Atom(1, 0.5000000805882481, 0.5000000805882481, 0.013668500721915418),
            Atom(1, 0.5769230060071642, 0.11538474325013864, 0.013668500721915418),
            Atom(1, 0.6538459314260802, 0.7307695670885254, 0.013668500721915418),
            Atom(1, 0.7307695670885254, 0.34615422975041593, 0.013668500721915418),
            Atom(1, 0.8076924925074415, 0.9615383433452735, 0.013668500721915418),
            Atom(1, 0.8846154179263575, 0.5769230060071642, 0.013668500721915418),
            Atom(1, 0.9615383433452735, 0.19230766866905472, 0.013668500721915418),
            Atom(1, 0.11538474325013864, 0.423077155169332, 0.013668500721915418),
            Atom(1, 0.2692305940879708, 0.6538459314260802, 0.013668500721915418),
            Atom(1, 0.423077155169332, 0.8846154179263575, 0.013668500721915418),
            Atom(1, 0.03846181783122258, 0.8076924925074415, 0.013668500721915418),
            Atom(3, 0.0, 0.0, 0.0),
            Atom(3, 0.15384585083783214, 0.2307694865002773, 0.0),
            Atom(3, 0.30769241191919333, 0.4615382627570255, 0.0),
            Atom(3, 0.38461533733810943, 0.07692292541891607, 0.0),
            Atom(3, 0.4615382627570255, 0.6923077492573028, 0.0),
            Atom(3, 0.5384618984194707, 0.30769241191919333, 0.0),
            Atom(3, 0.6153848238383867, 0.92307723575758, 0.0),
            Atom(3, 0.6923077492573028, 0.5384618984194707, 0.0),
            Atom(3, 0.7692306746762189, 0.15384585083783214, 0.0),
            Atom(3, 0.846154310338664, 0.7692306746762189, 0.0),
            Atom(3, 0.92307723575758, 0.38461533733810943, 0.0),
            Atom(3, 0.07692292541891607, 0.6153848238383867, 0.0),
            Atom(3, 0.2307694865002773, 0.846154310338664, 0.0),
        ],
            [0.     , 0.     , 1.94831],
            LayerType.SURF,
            'Sr layer'
        ),
        Layer([
            Atom(2, 0.0, 0.0, 0.0),
            Atom(2, 0.15384585083783214, 0.2307694865002773, 0.0),
            Atom(2, 0.30769241191919333, 0.4615382627570255, 0.0),
            Atom(2, 0.38461533733810943, 0.07692292541891607, 0.0),
            Atom(2, 0.4615382627570255, 0.6923077492573028, 0.0),
            Atom(2, 0.5384618984194707, 0.30769241191919333, 0.0),
            Atom(2, 0.6153848238383867, 0.92307723575758, 0.0),
            Atom(2, 0.6923077492573028, 0.5384618984194707, 0.0),
            Atom(2, 0.7692306746762189, 0.15384585083783214, 0.0),
            Atom(2, 0.846154310338664, 0.7692306746762189, 0.0),
            Atom(2, 0.92307723575758, 0.38461533733810943, 0.0),
            Atom(2, 0.07692292541891607, 0.6153848238383867, 0.0),
            Atom(2, 0.2307694865002773, 0.846154310338664, 0.0),
            Atom(4, 0.2692305940879708, 0.15384585083783214, 0.01175994806466375),
            Atom(4, 0.423077155169332, 0.38461533733810943, 0.01175994806466375),
            Atom(4, 0.5000000805882481, 0.0, 0.01175994806466375),
            Atom(4, 0.5769230060071642, 0.6153848238383867, 0.01175994806466375),
            Atom(4, 0.6538459314260802, 0.2307694865002773, 0.01175994806466375),
            Atom(4, 0.7307695670885254, 0.846154310338664, 0.01175994806466375),
            Atom(4, 0.8076924925074415, 0.4615382627570255, 0.01175994806466375),
            Atom(4, 0.8846154179263575, 0.07692292541891607, 0.01175994806466375),
            Atom(4, 0.9615383433452735, 0.6923077492573028, 0.01175994806466375),
            Atom(4, 0.03846181783122258, 0.30769241191919333, 0.01175994806466375),
            Atom(4, 0.19230766866905472, 0.5384618984194707, 0.01175994806466375),
            Atom(4, 0.34615422975041593, 0.7692306746762189, 0.01175994806466375),
            Atom(4, 0.11538474325013864, 0.92307723575758, 0.01175994806466375),
            Atom(4, 0.07692292541891607, 0.11538474325013864, 0.01175994806466375),
            Atom(4, 0.2307694865002773, 0.34615422975041593, 0.01175994806466375),
            Atom(4, 0.38461533733810943, 0.5769230060071642, 0.01175994806466375),
            Atom(4, 0.4615382627570255, 0.19230766866905472, 0.01175994806466375),
            Atom(4, 0.5384618984194707, 0.8076924925074415, 0.01175994806466375),
            Atom(4, 0.6153848238383867, 0.423077155169332, 0.01175994806466375),
            Atom(4, 0.7692306746762189, 0.6538459314260802, 0.01175994806466375),
            Atom(4, 0.846154310338664, 0.2692305940879708, 0.01175994806466375),
            Atom(4, 0.92307723575758, 0.8846154179263575, 0.01175994806466375),
            Atom(4, 0.0, 0.5000000805882481, 0.01175994806466375),
            Atom(4, 0.15384585083783214, 0.7307695670885254, 0.01175994806466375),
            Atom(4, 0.30769241191919333, 0.9615383433452735, 0.01175994806466375),
            Atom(4, 0.6923077492573028, 0.03846181783122258, 0.01175994806466375),
        ],
            [0.     , 0.     , 1.89567],
            LayerType.BULK,
            'Ti layer'
        ),
        Layer([
            Atom(1, 0.19230766866905472, 0.03846181783122258, 0.006243592335990403),
            Atom(1, 0.34615422975041593, 0.2692305940879708, 0.006243592335990403),
            Atom(1, 0.5000000805882481, 0.5000000805882481, 0.006243592335990403),
            Atom(1, 0.5769230060071642, 0.11538474325013864, 0.006243592335990403),
            Atom(1, 0.6538459314260802, 0.7307695670885254, 0.006243592335990403),
            Atom(1, 0.7307695670885254, 0.34615422975041593, 0.006243592335990403),
            Atom(1, 0.8076924925074415, 0.9615383433452735, 0.006243592335990403),
            Atom(1, 0.8846154179263575, 0.5769230060071642, 0.006243592335990403),
            Atom(1, 0.9615383433452735, 0.19230766866905472, 0.006243592335990403),
            Atom(1, 0.11538474325013864, 0.423077155169332, 0.006243592335990403),
            Atom(1, 0.2692305940879708, 0.6538459314260802, 0.006243592335990403),
            Atom(1, 0.423077155169332, 0.8846154179263575, 0.006243592335990403),
            Atom(1, 0.03846181783122258, 0.8076924925074415, 0.006243592335990403),
            Atom(3, 0.0, 0.0, 0.0),
            Atom(3, 0.15384585083783214, 0.2307694865002773, 0.0),
            Atom(3, 0.30769241191919333, 0.4615382627570255, 0.0),
            Atom(3, 0.38461533733810943, 0.07692292541891607, 0.0),
            Atom(3, 0.4615382627570255, 0.6923077492573028, 0.0),
            Atom(3, 0.5384618984194707, 0.30769241191919333, 0.0),
            Atom(3, 0.6153848238383867, 0.92307723575758, 0.0),
            Atom(3, 0.6923077492573028, 0.5384618984194707, 0.0),
            Atom(3, 0.7692306746762189, 0.15384585083783214, 0.0),
            Atom(3, 0.846154310338664, 0.7692306746762189, 0.0),
            Atom(3, 0.92307723575758, 0.38461533733810943, 0.0),
            Atom(3, 0.07692292541891607, 0.6153848238383867, 0.0),
            Atom(3, 0.2307694865002773, 0.846154310338664, 0.0),
        ],
            [0.     , 0.     , 1.94831],
            LayerType.BULK,
            'Sr layer'
        ),
    ],
    [14.079677730686877, 14.079677730686877, 2.8188900000000015]
)

TEST_DOUB_FESE_1UC_2x1 = AtomicStructure(
    # Atomic sites
    [
        Site([1.0, 0.0, 0.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"],
             "Sr bulk"),
        Site([0.0, 1.0, 0.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"],
             "Ti bulk"),
        Site([0.0, 0.0, 1.0, 0.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"],
             "apO bulk"),
        Site([0.0, 0.0, 0.0, 1.0, 0.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"],
             "eqO bulk"),
        Site([0.0, 0.0, 0.0, 0.0, 1.0, 0.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"],
             "Fe film"),
        Site([0.0, 0.0, 0.0, 0.0, 0.0, 1.0], 0.1, ["Sr", "Ti", "apO", "eqO", "Fe", "Se"],
             "Se film"),
    ],
    # Layer definitions (fractional coordinates)
    [
        Layer([
            Atom(5, 0.25, 0.50, 0.25),   # Top Layer Fe, cell 1
            Atom(5, 0.50, 0.00, 0.25),   # Top Layer Fe, cell 1
            Atom(6, 0.25, 0.00, 0.00),   # Top Layer Se, cell 1
            Atom(6, 0.50, 0.50, 0.50),   # Top Layer Se, cell 1
            Atom(5, 0.75, 0.50, 0.25),   # Top Layer Fe, cell 2
            Atom(5, 1.00, 0.00, 0.25),   # Top Layer Fe, cell 2
            Atom(6, 0.75, 0.00, 0.00),   # Top Layer Se, cell 2
            Atom(6, 1.00, 0.50, 0.50),   # Top Layer Se, cell 2
        ], [0.0, 0.0, 5.5180 / 2],
            LayerType.SURF,
            "Top FeSe film",
        ),
        Layer([
            Atom(2, 0.75, 0.00, 0.00),   # Ti, doubled overlayer, cell 1
            Atom(2, 0.50, 0.50, 0.00),   # Ti, doubled overlayer, cell 2
            Atom(4, 0.50, 0.00, 0.00),   # O, doubled overlayer, cell 1
            Atom(4, 0.75, 0.50, 0.00),   # O, doubled overlayer, cell 1
            Atom(4, 0.25, 0.50, 0.00),   # O, doubled overlayer, cell 2
            Atom(4, 0.00, 0.00, 0.00),   # O, doubled overlayer, cell 2
        ], [0.0, 0.0, 3.905 / 2],
            LayerType.SURF,
            "TiO2 doubled overlayer",
        ),
        Layer([
            Atom(2, 0.25, 0.50, 0.00),  # Ti, bulk, cell 1
            Atom(2, 0.75, 0.50, 0.00),  # Ti, bulk, cell 2
            Atom(4, 0.00, 0.50, 0.00),  # O, bulk, cell 1
            Atom(4, 0.25, 0.00, 0.00),  # O, bulk, cell 1
            Atom(4, 0.50, 0.00, 0.00),  # O, bulk, cell 2
            Atom(4, 0.75, 0.00, 0.00),  # O, bulk, cell 2
        ], [0.0, 0.0, 3.905 / 2],
            LayerType.BULK,
            "SrTiO3 bulk -- TiO2",
        ),
        Layer([
            Atom(1, 0.00, 0.00, 0.00),   # Sr, bulk, cell 1
            Atom(1, 0.50, 0.00, 0.00),   # Sr, bulk, cell 2
            Atom(3, 0.25, 0.50, 0.00),   # O, bulk, cell 1
            Atom(3, 0.75, 0.50, 0.00),   # O, bulk, cell 2
        ], [0.0, 0.0, 3.905 / 2],
            LayerType.BULK,
            "SrTiO3 bulk -- SrO",
        ),
    ],
    # Unit cell parameters
    [7.810, 3.905, 3.905]
)


LANIO3 = AtomicStructure(
    # Atomic sites
    [
     Site([0.0, 0.0, 1.0, 0.0], 0.14,   ["apO", "eqO", "La", "Ni"], "La top layer"),
     Site([0.0, 0.0, 1.0, 0.0], 0.02,   ["apO", "eqO", "La", "Ni"], "La 2nd layer"),
     Site([0.0, 0.0, 1.0, 0.0], 0.0298,  ["apO", "eqO", "La", "Ni"], "La bulk"),
     Site([0.0, 0.0, 0.0, 1.0], 0.02,   ["apO", "eqO", "La", "Ni"], "Ni top layer"),
     Site([0.0, 0.0, 0.0, 1.0], 0.04,   ["apO", "eqO", "La", "Ni"], "Ni 2nd layer"),
     Site([0.0, 0.0, 0.0, 1.0], 0.0298, ["apO", "eqO", "La", "Ni"], "Ni bulk"),
     Site([1.0, 0.0, 0.0, 0.0], 0.14,   ["apO", "eqO", "La", "Ni"], "apO top layer"),
     Site([1.0, 0.0, 0.0, 0.0], 0.14,   ["apO", "eqO", "La", "Ni"], "apO 2nd layer"),
     Site([1.0, 0.0, 0.0, 0.0], 0.0528, ["apO", "eqO", "La", "Ni"], "apO bulk"),
     Site([0.0, 1.0, 0.0, 0.0], 0.20,   ["apO", "eqO", "La", "Ni"], "eqO top layer"),
     Site([0.0, 1.0, 0.0, 0.0], 0.18,   ["apO", "eqO", "La", "Ni"], "eqO 2nd layer"),
     Site([0.0, 1.0, 0.0, 0.0], 0.0528, ["apO", "eqO", "La", "Ni"], "eqO bulk"),
    ],
    # Layer definitions
    [
     Layer([
        Atom(1,  0.5, 0.5, 0.0),
        Atom(7,  0.0, 0.0, 0.0),
        Atom(4,  0.0, 0.0, 0.5),
        Atom(10, 0.5, 0.0, 0.5),
        Atom(10, 0.0, 0.5, 0.5),
        Atom(2,  0.5, 0.5, 1.0),
        Atom(8,  0.0, 0.0, 1.0),
        Atom(5,  0.0, 0.0, 1.5),
        Atom(11, 0.5, 0.0, 1.5),
        Atom(11, 0.0, 0.5, 1.5),
     ], [0.0, 0.0, 3.9000 / 2],
        LayerType.SURF,
        "Top 2 unit cells"
     ),
     Layer([
        Atom(3,  0.5, 0.5, 0.0),
        Atom(9,  0.0, 0.0, 0.0),
        Atom(6,  0.0, 0.0, 0.5),
        Atom(12, 0.5, 0.0, 0.5),
        Atom(12, 0.0, 0.5, 0.5)
     ], [0.0, 0.0, 3.9000 / 2],
        LayerType.BULK,
        "Bulk"
     )
    ],
    # Unit cell parameters
    [3.7910, 3.7910, 3.9000]
)

LANIO3_PROBLEM = SearchSpace(
    LANIO3,
    [
        (SearchKey.ATOMZ,  1, (-0.066, 0.066)),
        (SearchKey.ATOMZ,  2, (-0.066, 0.066)),
        (SearchKey.ATOMZ,  3, (-0.066, 0.066)),
        (SearchKey.ATOMZ,  4, (-0.066, 0.066)),
        (SearchKey.ATOMZ,  6, (-0.066, 0.066)),
        (SearchKey.ATOMZ,  7, (-0.066, 0.066)),
        (SearchKey.ATOMZ,  8, (-0.066, 0.066)),
        (SearchKey.ATOMZ,  9, (-0.066, 0.066)),
    ],
    constraints=[  # Bind matching eqOs to be equal in z coordinate
        EqualityConstraint(SearchKey.ATOMZ, 4, SearchKey.ATOMZ, 5),
        EqualityConstraint(SearchKey.ATOMZ, 9, SearchKey.ATOMZ, 10),
    ]
)

# Absolute coordinate shifts!
LANIO3_SOLUTION = np.array(
    [0.2200, -0.1800, 0.0000, -0.0500, 0.0900, -0.0800, -0.0100, -0.0100]
)

LANIO3_SOLUTION_RFACTOR = 0.2794


FESE_20UC_PROBLEM = SearchSpace(
    FESE_20UC,
    [
        (SearchKey.ATOMZ, 1, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 2, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 3, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 4, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 5, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 6, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 7, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 8, (-0.1, 0.1)),
        (SearchKey.VIB,   1, (-0.08, 0.1)),
        (SearchKey.VIB,   4, (-0.08, 0.1)),
        (SearchKey.CELLA, -1, (-0.001, 0.001)),
        (SearchKey.CELLC, -1, (-0.010, 0.010)),
    ],
    constraints=[   # Bind cell's a and b axes, and vertical displacement of Se atoms
        EqualityConstraint(SearchKey.CELLA, -1, SearchKey.CELLB, -1),
        EqualityConstraint(SearchKey.VIB, 1, SearchKey.VIB, 2),
        EqualityConstraint(SearchKey.VIB, 1, SearchKey.VIB, 3),
        EqualityConstraint(SearchKey.VIB, 4, SearchKey.VIB, 5),
        EqualityConstraint(SearchKey.VIB, 4, SearchKey.VIB, 6),
        # (SearchKey.ATOMZ,  5, SearchKey.ATOMZ,  7),
        # (SearchKey.ATOMZ,  6, SearchKey.ATOMZ,  8),
    ]
)

SQRT13_PROBLEM = SearchSpace(
    FESE_SQRT13_SCIENCE,
    # Just placeholders
    [
        (SearchKey.ATOMZ, 1, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 2, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 3, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 4, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 5, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 6, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 7, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 8, (-0.1, 0.1)),
    ]
)


# FESE_20UC_DELTA_PROBLEM = SearchSpace(
#     FESE_20UC_NEW_CELL_PARAMS,
#     [
#         (SearchKey.ATOMZ, 1, (-0.1, 0.1)),
#         (SearchKey.ATOMZ, 2, (-0.1, 0.1)),
#         (SearchKey.ATOMZ, 3, (-0.1, 0.1)),
#         (SearchKey.ATOMZ, 4, (-0.1, 0.1)),
#         (SearchKey.ATOMZ, 5, (-0.1, 0.1)),
#         (SearchKey.ATOMZ, 6, (-0.1, 0.1)),
#         (SearchKey.ATOMZ, 7, (-0.1, 0.1)),
#         (SearchKey.ATOMZ, 8, (-0.1, 0.1)),
#         (SearchKey.VIB, 1, (-0.08, 0.1)),
#         (SearchKey.VIB, 4, (-0.08, 0.1)),
#     ],
#     constraints=[  # Bind cell's a and b axes, and vertical displacement of Se atoms
#         EqualityConstraint(SearchKey.VIB, 1, SearchKey.VIB, 2),
#         EqualityConstraint(SearchKey.VIB, 1, SearchKey.VIB, 3),
#         EqualityConstraint(SearchKey.VIB, 4, SearchKey.VIB, 5),
#         EqualityConstraint(SearchKey.VIB, 4, SearchKey.VIB, 6),
#     ]
# )
#
# FESE_20UC_SINGLEZ_PROBLEM = SearchSpace(
#     FESE_20UC,
#     [
#         (SearchKey.ATOMZ, 1, (-0.05, 0.05)),
#         (SearchKey.ATOMZ, 2, (-0.05, 0.05)),
#         (SearchKey.ATOMZ, 5, (-0.05, 0.05)),
#         (SearchKey.ATOMZ, 6, (-0.05, 0.05)),
#         (SearchKey.VIB,   1, (-0.08, 0.1)),
#         (SearchKey.VIB,   4, (-0.08, 0.1)),
#         (SearchKey.CELLA, -1, (-0.010, 0.010)),
#         (SearchKey.CELLC, -1, (-0.010, 0.010)),
#     ],
#     constraints=[
#         EqualityConstraint(SearchKey.CELLA, -1, SearchKey.CELLB, -1),
#         EqualityConstraint(SearchKey.VIB, 1, SearchKey.VIB, 2),
#         EqualityConstraint(SearchKey.VIB, 1, SearchKey.VIB, 3),
#         EqualityConstraint(SearchKey.VIB, 4, SearchKey.VIB, 5),
#         EqualityConstraint(SearchKey.VIB, 4, SearchKey.VIB, 6),
#     ]
# )
#
#
# FESE_20UC_SECOND_SINGLEXY_PROBLEM = SearchSpace(
#     FESE_20UC_SINGLEZREGRESSED,
#     [
#         (SearchKey.ATOMX, 1, (-0.05, 0.05)),
#         (SearchKey.ATOMX, 2, (-0.05, 0.05)),
#         (SearchKey.ATOMX, 5, (-0.05, 0.05)),
#         (SearchKey.ATOMX, 6, (-0.05, 0.05)),
#         (SearchKey.ATOMY, 1, (-0.05, 0.05)),
#         (SearchKey.ATOMY, 2, (-0.05, 0.05)),
#         (SearchKey.ATOMY, 5, (-0.05, 0.05)),
#         (SearchKey.ATOMY, 6, (-0.05, 0.05)),
#         (SearchKey.CELLA, -1, (-0.010, 0.010)),
#         (SearchKey.CELLC, -1, (-0.010, 0.010)),
#     ],
#     constraints=[
#         EqualityConstraint(SearchKey.CELLA, -1, SearchKey.CELLB, -1),
#     ]
# )
#
#
# TEST_FESE_20UC_2D_PROBLEM = SearchSpace(
#     TEST_FESE_20UC_FOR2D,
#     [
#         (SearchKey.ATOMZ, 1, (-0.05, 0.05)),
#         (SearchKey.ATOMZ, 2, (-0.05, 0.05)),
#     ],
#     constraints=[
#     ]
# )
#
#
# FESE_20UC_PROBLEM_SECONDXY = SearchSpace(
#     FESE_20UC_CLOSE,
#     [
#         (SearchKey.CELLA, -1, (-0.01, 0.01)),
#         (SearchKey.ATOMY, 1, (-0.1, 0.1)),
#         (SearchKey.ATOMY, 2, (-0.1, 0.1)),
#         (SearchKey.ATOMY, 3, (-0.1, 0.1)),
#         (SearchKey.ATOMY, 4, (-0.1, 0.1)),
#         (SearchKey.ATOMY, 5, (-0.1, 0.1)),
#         (SearchKey.ATOMY, 6, (-0.1, 0.1)),
#         (SearchKey.ATOMY, 7, (-0.1, 0.1)),
#         (SearchKey.ATOMY, 8, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 1, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 2, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 3, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 4, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 5, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 6, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 7, (-0.1, 0.1)),
#         (SearchKey.ATOMX, 8, (-0.1, 0.1)),
#     ],
#     constraints=[   # Bind cell's a and b axes, and vertical displacement of Se atoms
#         EqualityConstraint(SearchKey.CELLA, -1, SearchKey.CELLB, -1),
#     ]
# )


FESE_1UC_1x1_PROBLEM = SearchSpace(
    FESE_1UC_1x1,
    [
        (SearchKey.CELLA, -1, (-0.01, 0.01)),
        (SearchKey.ATOMZ,  1, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  2, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  3, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  4, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  5, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  6, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  7, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  8, (-0.05, 0.05)),
        (SearchKey.ATOMZ,  9, (-0.05, 0.05)),
        (SearchKey.ATOMZ, 10, (-0.05, 0.05)),
        (SearchKey.ATOMZ, 11, (-0.05, 0.05)),
        (SearchKey.ATOMZ, 12, (-0.05, 0.05)),
        (SearchKey.INTZ, 1, (0.0, 0.1)),
        (SearchKey.INTZ, 2, (0.0, 0.1)),
        (SearchKey.INTZ, 3, (0.0, 0.1)),
    ],
    constraints=[   # Bind cell's a axis to be twice the b axis
        EqualityConstraint(SearchKey.CELLA, -1, SearchKey.CELLB, -1),
    ]
)

FESE_1UC_2x1_PROBLEM = SearchSpace(
    FESE_1UC_2x1,
    [
        (SearchKey.CELLB, -1, (-0.01, 0.01)),
        (SearchKey.CELLC, -1, (-0.01, 0.01)),
        (SearchKey.ATOMZ,  1, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  2, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  3, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  4, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  5, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  6, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  7, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  8, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  9, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 10, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 11, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 12, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 13, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 14, (-0.1, 0.1)),
    ],
    constraints=[   # Bind cell's a axis to be twice the b axis
        LambdaConstraint(SearchKey.CELLB, -1, SearchKey.CELLA, -1, lambda x: 2*x)
    ]
)

TEST_DOUB_FESE_1UC_PROBLEM = SearchSpace(
    TEST_DOUB_FESE_1UC_2x1,
    [
        (SearchKey.CELLB, -1, (-0.01, 0.01)),
        (SearchKey.CELLC, -1, (-0.01, 0.01)),
        (SearchKey.INTZ, 1, (0.0, 0.3)),
        (SearchKey.INTZ, 2, (-0.1, 0.2)),
        (SearchKey.ATOMZ,  1, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  2, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  3, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  4, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  5, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  6, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  7, (-0.1, 0.1)),
        (SearchKey.ATOMZ,  9, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 10, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 11, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 12, (-0.1, 0.1)),
        (SearchKey.ATOMZ, 13, (-0.1, 0.1)),
        (SearchKey.ATOMX, 1, (0.0, 0.5)),
        (SearchKey.ATOMY, 1, (0.0, 0.5)),
    ],
    constraints=[   # Bind cell's a axis to be twice the b axis
        LambdaConstraint(SearchKey.CELLB, -1, SearchKey.CELLA, -1, lambda x: 2*x),
        # Allow an overal registry shift
        EqualShiftConstraint(SearchKey.ATOMX, 1, SearchKey.ATOMX, 2),
        EqualShiftConstraint(SearchKey.ATOMX, 1, SearchKey.ATOMX, 3),
        EqualShiftConstraint(SearchKey.ATOMX, 1, SearchKey.ATOMX, 4),
        EqualShiftConstraint(SearchKey.ATOMX, 1, SearchKey.ATOMX, 5),
        EqualShiftConstraint(SearchKey.ATOMX, 1, SearchKey.ATOMX, 6),
        EqualShiftConstraint(SearchKey.ATOMX, 1, SearchKey.ATOMX, 7),
        EqualShiftConstraint(SearchKey.ATOMX, 1, SearchKey.ATOMX, 8),
        EqualShiftConstraint(SearchKey.ATOMY, 1, SearchKey.ATOMY, 2),
        EqualShiftConstraint(SearchKey.ATOMY, 1, SearchKey.ATOMY, 3),
        EqualShiftConstraint(SearchKey.ATOMY, 1, SearchKey.ATOMY, 4),
        EqualShiftConstraint(SearchKey.ATOMY, 1, SearchKey.ATOMY, 5),
        EqualShiftConstraint(SearchKey.ATOMY, 1, SearchKey.ATOMY, 6),
        EqualShiftConstraint(SearchKey.ATOMY, 1, SearchKey.ATOMY, 7),
        EqualShiftConstraint(SearchKey.ATOMY, 1, SearchKey.ATOMY, 8),
    ]
)

STO_1x1_PROBLEM = SearchSpace(
    STO_1x1,
    [
        # Relax the lattice constants
        (SearchKey.CELLB, -1, (-0.02, 0.02)),
        (SearchKey.CELLC, -1, (-0.02, 0.02)),
        # Surface atomic coordinates
        (SearchKey.INTZ, 1, (0.0, 0.3)),
        (SearchKey.INTZ, 2, (0.0, 0.3)),
        (SearchKey.INTZ, 3, (0.0, 0.3)),
        (SearchKey.ATOMZ, 1, (0.0, 0.3)),
        (SearchKey.ATOMZ, 2, (0.0, 0.3)),
        (SearchKey.ATOMZ, 4, (0.0, 0.3)),
        (SearchKey.ATOMZ, 5, (0.0, 0.3)),
        (SearchKey.ATOMZ, 7, (0.0, 0.3)),
        # Let the doubled TiO2 layer have some nonzero xy motion
        (SearchKey.ATOMX, 1, (-0.3, 0.3)),
        (SearchKey.ATOMX, 2, (-0.3, 0.3)),
        (SearchKey.ATOMX, 3, (-0.3, 0.3)),
        (SearchKey.ATOMY, 1, (-0.3, 0.3)),
        (SearchKey.ATOMY, 2, (-0.3, 0.3)),
        (SearchKey.ATOMY, 3, (-0.3, 0.3)),
        # Vibrational params
        (SearchKey.VIB, 1, (-0.08, 0.1)),
        (SearchKey.VIB, 2, (-0.08, 0.1)),
        (SearchKey.VIB, 3, (-0.08, 0.1)),
        (SearchKey.VIB, 4, (-0.08, 0.1)),
    ],
    constraints=[
        EqualityConstraint(SearchKey.CELLB, -1, SearchKey.CELLA, -1),
    ]
)


STO_2x1_PROBLEM = SearchSpace(
    STO_2x1,
    [
        # Relax the lattice constants
        (SearchKey.CELLB, -1, (-0.02, 0.02)),
        (SearchKey.CELLC, -1, (-0.02, 0.02)),
        # Surface atomic coordinates
        (SearchKey.INTZ, 1, (0.0, 0.3)),
        (SearchKey.INTZ, 2, (0.0, 0.3)),
        (SearchKey.INTZ, 3, (0.0, 0.3)),
        (SearchKey.ATOMZ, 1, (0.0, 0.3)),
        (SearchKey.ATOMZ, 2, (0.0, 0.3)),
        (SearchKey.ATOMZ, 3, (0.0, 0.3)),
        (SearchKey.ATOMZ, 4, (0.0, 0.3)),
        (SearchKey.ATOMZ, 5, (0.0, 0.3)),
        (SearchKey.ATOMZ, 7, (0.0, 0.3)),
        (SearchKey.ATOMZ, 8, (0.0, 0.3)),
        (SearchKey.ATOMZ, 9, (0.0, 0.3)),
        (SearchKey.ATOMZ, 10, (0.0, 0.3)),
        (SearchKey.ATOMZ, 11, (0.0, 0.3)),
        (SearchKey.ATOMZ, 13, (0.0, 0.3)),
        (SearchKey.ATOMZ, 13, (0.0, 0.3)),
        (SearchKey.ATOMZ, 14, (0.0, 0.3)),
        # Let the doubled TiO2 layer have some nonzero xy motion
        (SearchKey.ATOMX, 1, (-0.3, 0.3)),
        (SearchKey.ATOMX, 2, (-0.3, 0.3)),
        (SearchKey.ATOMX, 3, (-0.3, 0.3)),
        (SearchKey.ATOMX, 4, (-0.3, 0.3)),
        (SearchKey.ATOMX, 5, (-0.3, 0.3)),
        (SearchKey.ATOMX, 6, (-0.3, 0.3)),
        (SearchKey.ATOMY, 1, (-0.3, 0.3)),
        (SearchKey.ATOMY, 2, (-0.3, 0.3)),
        (SearchKey.ATOMY, 3, (-0.3, 0.3)),
        (SearchKey.ATOMX, 4, (-0.3, 0.3)),
        (SearchKey.ATOMX, 5, (-0.3, 0.3)),
        (SearchKey.ATOMX, 6, (-0.3, 0.3)),
        # Vibrational params
        (SearchKey.VIB, 1, (-0.08, 0.1)),
        (SearchKey.VIB, 2, (-0.08, 0.1)),
        (SearchKey.VIB, 3, (-0.08, 0.1)),
        (SearchKey.VIB, 4, (-0.08, 0.1)),
    ],
    constraints=[
        LambdaConstraint(SearchKey.CELLB, -1, SearchKey.CELLA, -1, lambda x: 2 * x),
    ]
)

DEFAULT_DELTA_DISPS = np.zeros((21, 3))
DEFAULT_DELTA_DISPS[:, 2] = np.arange(-0.2, 0.22, step=0.02)
DEFAULT_DELTA_VIBS = np.arange(0.0, 0.3, step=0.05)

FESE_DELTA_SEARCHDIMS = [
    (1, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (2, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (3, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (4, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (5, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (6, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (7, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (8, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
]

FESE_SRTIO_DELTA_SEARCHDIMS = [
    (1, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (2, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (3, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (4, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (5, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (6, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (7, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (8, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (9, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (10, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (11, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
    (12, DEFAULT_DELTA_DISPS, DEFAULT_DELTA_VIBS),
]

problems = {
    "LANIO3":    LANIO3_PROBLEM,
    "FESE_20UC": FESE_20UC_PROBLEM,
    # "FESE_20UC_SECONDXY": FESE_20UC_PROBLEM_SECONDXY,
    # "FESE_20UC_SINGLEZ": FESE_20UC_SINGLEZ_PROBLEM,
    # "FESE_20UC_DELTA": FESE_20UC_DELTA_PROBLEM,
    # "FESE_20UC_SECOND_SINGLEXY": FESE_20UC_SECOND_SINGLEXY_PROBLEM,
    # "TEST_FESE_2D": TEST_FESE_20UC_2D_PROBLEM,
    "FESE_1UC_1x1": FESE_1UC_1x1_PROBLEM,
    "STO_1x1": STO_1x1_PROBLEM,
    "STO_2x1": STO_2x1_PROBLEM,
    "SQRT13": SQRT13_PROBLEM,
}
